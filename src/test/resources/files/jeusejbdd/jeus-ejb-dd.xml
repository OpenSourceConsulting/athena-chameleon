<?xml version="1.0"?>
<jeus-ejb-dd xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.tmaxsoft.com/xml/ns/jeus" 
             xsi:schemaLocation="http://www.tmaxsoft.com/xml/ns/jeus schema/v5_0/jeus-ejb-dd.xsd">
	<module-info>
		<role-permission>
			<principal>peter</principal>
			<role>manager</role>
		</role-permission>
	</module-info>
	<beanlist>
		<jeus-bean>
			<ejb-name>counter</ejb-name>
			<export-name>counterEJB</export-name>
			<local-export-name>counterEJB_Local</local-export-name>
			<export-port>7654</export-port>
			<!--<export-iiop>true</export-iiop> -->
			<export-iiop>
				<only-iiop>false</only-iiop>
			</export-iiop>
			<single-vm-only>true</single-vm-only>
			<local-invoke-optimize>true</local-invoke-optimize>
			<use-access-control>true</use-access-control>
			<run-as-identity>
				<principal-name><![CDATA[principal]]></principal-name>
			</run-as-identity>
			<security-interop>
				<client-auth>Requires</client-auth>
				<identity-assertion>NotSupported</identity-assertion>
			</security-interop>
			<env>
				<type>java.lang.Integer</type>
				<name>minAmount</name>
				<value>100</value>
			</env>
			<ejb-ref>
				<jndi-info>
					<ref-name>AccountEJB</ref-name>
					<export-name>ACCEJB</export-name>
				</jndi-info>
			</ejb-ref>
			<res-ref>
				<jndi-info>
					<ref-name>jdbc/DBDS</ref-name>
					<export-name>ACCOUNTDB</export-name>
				</jndi-info>
			</res-ref>
			<res-env-ref>
				<jndi-info>
					<ref-name>jdbc/DBDS</ref-name>
					<export-name>ACCOUNTDB</export-name>
				</jndi-info>
			</res-env-ref>
			<service-ref>
				<service-client>
					<service-ref-name>ServiceJNDI</service-ref-name>
				</service-client>
			</service-ref>
			<thread-max>200</thread-max>
			<clustering>
				<enable-clustering>true</enable-clustering>
			</clustering>
			<invoke-http>
				<url>/mycontext/RMIServletHandler</url>
				<http-port>80</http-port>
			</invoke-http>
			<pooling-bean>true</pooling-bean>
			<object-management>
				<bean-pool>
					<pool-min>10</pool-min>
					<pool-max>200</pool-max>
				</bean-pool>
				<connect-pool>
					<pool-min>10</pool-min>
					<pool-max>200</pool-max>
				</connect-pool>
				<passivation-timeout>10000</passivation-timeout>
				<disconnect-timeout>1800000</disconnect-timeout>
			</object-management>
			<schema-info>
				<table-name>ACCOUNT</table-name>
				<cm-field>
					<field>id</field>
					<column-name>ID</column-name>
					<type>NUMERIC</type>
					<exclude-field>false</exclude-field>
				</cm-field>
				<cm-field>
					<field>customer_addr</field>
					<column-name>customer_address</column-name>
					<type>VARCHAR(30)</type>
					<exclude-field>false</exclude-field>
				</cm-field>
				<creating-table>
					<use-existing-table />
				</creating-table>
				<deleting-table>true</deleting-table>
				<prim-key-field>
					<field>id</field>
				</prim-key-field>
				<find-method>
					<query-method>
						<method-name>findByAddress</method-name>
						<method-params>
							<method-param>java.lang.String</method-param>
							<method-param>java.lang.Integer</method-param>
						</method-params>
					</query-method>
					<sql>customer_address=?</sql>
					<include-updates>true</include-updates>
				</find-method>
				<jeus-query>
					<query-method>
						<method-name>findByTitle</method-name>
						<method-params>
							<method-param>java.lang.String</method-param>
						</method-params>
					</query-method>
					<sql>
						SELECT OBJECT(b) FROM Book b
						WHERE b.title = ?1 ORDERBY b.price
					</sql>
					<include-updates>true</include-updates>
				</jeus-query>
				<db-vendor>oracle</db-vendor>
				<data-source-name>MYDB</data-source-name>
				<auto-key-generator>
					<generator-type>ORACLE</generator-type>
					<generator-name>my_generator</generator-name>
					<sequence-column>PrimKeyGeneratorColumn</sequence-column>
					<key-cache-size>20</key-cache-size>
				</auto-key-generator>
			</schema-info>
			<cm-persistence-optimize>
				<subengine-type>WriteLocking</subengine-type>
				<fetch-size>80</fetch-size>
				<init-caching>true</init-caching>
			</cm-persistence-optimize>
			<enable-instant-ql>true</enable-instant-ql>
			<ack-mode>Auto-acknowledge</ack-mode>
			<durable>Durable</durable>
			<durable-timer-service>
				<ignore-durable-timers-at-deploy>true</ignore-durable-timers-at-deploy>
			</durable-timer-service>
		</jeus-bean>
	</beanlist>
	<ejb-relation-map>
		<relation-name>student-course</relation-name>
		<table-name>STUDENTCOURSEJOIN</table-name>
		<jeus-relationship-role>
			<relationship-role-name>student</relationship-role-name>
			<column-map>
				<foreign-key-column>
					student-id <!--This column in join table -->
				</foreign-key-column>
				<target-primary-key-column>
					stu-id <!--This column in student table -->
				</target-primary-key-column>
			</column-map>
		</jeus-relationship-role>
		<jeus-relationship-role>
			<relationship-role-name>course</relationship-role-name>
			<column-map>
				<foreign-key-column>
					course-id <!--This column in join table -->
				</foreign-key-column>
				<target-primary-key-column>
					cou-id <!--This column in course table -->
				</target-primary-key-column>
			</column-map>
		</jeus-relationship-role>
	</ejb-relation-map>
	<message-destination>
		<jndi-info>
			<ref-name>ejb/AccountEJB</ref-name>
			<export-name>ACCEJB</export-name>
		</jndi-info>
	</message-destination>
</jeus-ejb-dd> 